<!doctype html>
<html lang="en">

<head>
<meta charset="utf-8">

<title>Git - Practical Tips</title>

<meta name="author" content="Anders Janmyr">

<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

<link rel="stylesheet" href="reveal.js/css/reveal.min.css">
<link rel="stylesheet" href="reveal.js/css/theme/default.css" id="theme">

<!-- For syntax highlighting -->
<link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">
<link rel="stylesheet" href="local.css">

<!-- If the query includes 'print-pdf', use the PDF print sheet -->
<script>
document.write( '<link rel="stylesheet" href="reveal.js/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
</script>

<!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->
</head>

<body>

<div class="reveal">

    <!-- Any section element inside of this container is displayed as a slide -->
    <div class="slides">
        <section data-markdown>
            # Git
            ## Some practical tips
            ### http://anders.janmyr.com
            ### @andersjanmyr
            ### anders.janmyr@jayway.com
        </section>

        <section>
            <section data-markdown>
                # Basics
                ![basics](basics.jpg)
            </section>
            <section data-markdown>
                # Nothing Committed is *Ever* Lost
            </section>
            <section data-markdown>
                # DAG
                ## Directed Acyclic Graph
                ![git-dag](git-dag.jpg)
            </section>
            <section data-markdown>
                # Three Parts
                * HEAD
                * Index
                * Working Dir
            </section>
            <section data-markdown>
                # `git add`
                ## Adds files to the index
            </section>
            <section data-markdown>
                # `git commit`
                ## Adds index files to the HEAD
            </section>
            <section data-markdown>
                # `git reset`
                ## Moves the head pointer
            </section>
            <section data-markdown>
                # Branch
                ## Pointer to a commit
                ### Moves with most commands
            </section>
            <section data-markdown>
                # Nothing Committed is *Ever* Lost
            </section>
        </section>

        <section>
            <section data-markdown>
                # History
                ![history](history.jpg)
            </section>
            <section data-markdown>
                # git rebase
                ![git-rebase.png](git-rebase.png)

                `git rebase` does NOT change the committed files
            </section>
            <section data-markdown>
                # git commit --amend

                    # Amend latest commit with files in index
                    $ git commit --amend

                    # And resuse the commit message
                    $ git commit --amend -C HEAD

                `git commit --amend` does NOT change the committed files
            </section>
            <section data-markdown>
                # git rebase -i
                ![git-rebase-interactive.png](git-rebase-interactive.png)

                `git rebase` does NOT change the committed files
            </section>
            <section data-markdown>
                # git cherry-pick
                ![cherrypick.png](cherrypick.png)

                `git cherry-pick` does NOT change the committed files
            </section>
            <section data-markdown>
                # git add -p

                    # Enter add patch mode
                    $ git add -p

                    Stage this hunk [y,n,q,a,d,/,k,K,j,J,g,e,?]? ?

            </section>
            <section data-markdown>
                # git add -p ?

                    y - stage this hunk
                    n - do not stage this hunk
                    q - quit; do not stage this hunk nor any other
                    a - stage this hunk and all later in the file
                    d - do not stage this hunk nor any later in the file
                    g - select a hunk to go to
                    / - search for a hunk matching the given regex
                    j - leave this hunk undecided, see next undecided hunk
                    J - leave this hunk undecided, see next hunk
                    k - leave this hunk undecided, see previous undecided
                    s - split the current hunk into smaller hunks
                    e - manually edit the current hunk
            </section>
            <section data-markdown>
                # git reset

                    # Moves the HEAD pointer back 4 steps
                    $ git reset HEAD~4

                    # Does NOT change working dir
                    $ git reset --mixed HEAD~4

                    # And adds the files to the index
                    # Does NOT change working dir
                    $ git reset --soft HEAD~4

                    # Also CHANGES working dir
                    $ git reset --hard HEAD~4

                `git reset` does NOT change the committed files
            </section>
            <section data-markdown>
                # git reflog

                Contains references to where `HEAD` has been.

                    $ git reflog
                    eb06230 HEAD@{0}: reset: moving to master
                    ccfaa12 HEAD@{1}: reset: moving to head~
                    7b8a6cb HEAD@{2}: reset: moving to head~
                    eb06230 HEAD@{3}: checkout: moving from master to an
                    eb06230 HEAD@{4}: commit: Added reset
                    7b8a6cb HEAD@{5}: reset: moving to 7b8a6cb59edbfde
                    69c6f00 HEAD@{6}: reset: moving to 69c6f00
                    1910819 HEAD@{7}: reset: moving to 1910819
            </section>
            <section data-markdown>
                # git log -g

                Contains the log for the reflog

                ![git-log-g](git-log-g.png)

            </section>
        </section>
        <section>
            <section data-markdown>
                # Finding in Git
                ![finding](finding.jpg)
            </section>
            <section data-markdown>
                # Where is my file?

                    $ git ls-files | grep security
                    lib/dynamo-db/security.js
                    test/security-test.jsP
            </section>
            <section data-markdown>
                # In what file can I find "crypt"?

                    $ git grep -n crypt
                    lib/dynamo-db/security.js:2:var crypto = require('crypto');
                    lib/dynamo-db/security.js:15:   var hmac = crypto.createHmac('sha256', key);

                ### `-n` - show line numbers
            </section>
            <section data-markdown>
                # Find "type"
                ## in revisions `master` and `8f0fb7f`.

                    git grep -l type  master 8f0fb7f
                    master:lib/dynamo-db/index.js
                    master:lib/dynamo-db/security.js
                    master:package.json
                    8f0fb7f:lib/dynamo-db/index.js
                    8f0fb7f:package.json

                ### `-l` - show filenames only
            </section>
            <section data-markdown>
                # Who deleted my file?

                    $ git log --diff-filter=D -- test/create-table-test.js
                    commit ba6c4d8bc165b8fb8208979c3e5513bd53477d51
                    Author: Anders Janmyr anders@janmyr.com
                    Date:   Wed Jan 25 09:46:52 2012 +0100

                        Removed the stupid failing test.

                ### --diff-filter - supports D, A, C, M, R
                ### --summary - adds information about the files
            </section>
            <section data-markdown>
                # When was it added?
                ## with partial name "inte"

                    $ git log --diff-filter=A --name-status |grep -C 6 inte
                    commit 09420cfea8c7b569cd47f690104750fec358a10a
                    Author: Anders Janmyr anders@janmyr.com
                    Date:   Tue Jan 24 16:23:52 2012 +0100

                        Extracted integration test

                    A integration-test/sts-test.js

                    commit 205db3965dec6c2c4c7b2bb75387a591d49e1951
                    Author: Anders Janmyr anders@janmyr.com
            </section>
            <section data-markdown>
                # Who changed that line?

                    $ git blame test/security-test.js
                    205db396 (Anders Janmyr 2012-01-21 10:03:59 +0100  1) var vows = require('vows'),
                    205db396 (Anders Janmyr 2012-01-21 10:03:59 +0100  2)     assert = require('assert');
                    205db396 (Anders Janmyr 2012-01-21 10:03:59 +0100  3)
                    09420cfe (Anders Janmyr 2012-01-24 16:23:52 +0100  4) var access = 'access';
                    09420cfe (Anders Janmyr 2012-01-24 16:23:52 +0100  5) var secret = 'secret';
            </section>
            <section data-markdown>
                # Who deleted that line?

                    $ git blame --reverse head~6..head security-test.js
                    558b8e7f (Anders Janmyr 2012-01-25 16:53:52 +0100  1) var vows = require('vows'),
                    558b8e7f (Anders Janmyr 2012-01-25 16:53:52 +0100  2)     assert = require('assert');
                    558b8e7f (Anders Janmyr 2012-01-25 16:53:52 +0100  3)
                    093c13e9 (Anders Janmyr 2012-01-24 17:26:09 +0100  4) var Security = require('dynamo-db').Security;
                    ba6c4d8b (Anders Janmyr 2012-01-25 09:46:52 +0100  5)
                    ^b96c68b (Anders Janmyr 2012-01-21 12:33:50 +0100  6) var access = process.env['S3_KEY'];
            </section>
            <section data-markdown>
                # What commits contain the string?

                    $ git log -Saws --diff-filter=M --patch
                    commit b96c68b839f204b310b79570bc3d27dc93cff588

                    diff --git a/lib/dynamo-db/security.js b/lib/dynamo-db/security.js
                    @@ -57,9 +58,10 @@ mod.url = function(host, path,...

                    var extParams = _.extend({}, this...
                    -  var signedParams = 'iam.amazonaws.com'
                    -  return request({ method: method,...
                    +  var signedParams = this.signedPa...
                    ...
            </section>
        </section>


        <section>
            <section data-markdown>
                # Config
                ![config](config.png)
            </section>
            <section data-markdown>
                ## Global `~/.gitconfig`

                    $ git config --global -l
                    user.name=Anders Janmyr
                    user.email=anders@janmyr.com
                    ...
                ## Local `./.git/config`

                    $ git config --local -l
                    remote.origin.url=git@github.com:andersjanmyr/git-...
                    remote.origin.fetch=+refs/heads/*:refs/remotes/origin/*
                    ...
            </section>
            <section data-markdown>
                # Automatic rebase pull

                    $ git config branch.master.rebase true

                Sets

                    [branch "master"]
                    rebase = true

            </section>
            <section data-markdown>
                # git-bash-completion

                    if [ -f /usr/local/etc/bash_completion.d/git-completion.bash ]
                    then
                        . /usr/local/etc/bash_completion.d/git-completion.bash
                    elif [ -f /etc/bash_completion.d/git ]; then
                        . /etc/bash_completion.d/git
                    fi

            </section>
            <section data-markdown>
                # Git Prompt

                    function prompt {
                        local sha=$(git rev-parse --short HEAD)
                        export PS1="[\!:\W ${sha}$(__git_ps1 '@%s')]\n$ "
                    }
                    PROMPT_COMMAND='prompt'

                    export GIT_PS1_SHOWDIRTYSTATE=true
                    export GIT_PS1_SHOWUNTRACKEDFILES=true
                    export GIT_PS1_SHOWUPSTREAM="auto"

                    [511:git-tips-and-tricks 50e6e0c@master *%=]
                    $
            </section>
            <section data-markdown>
                # Git Prompt
                ## `__git_ps1`

                    if [ -f /usr/local/etc/bash_completion.d/git-prompt.sh ]
                    then
                    . /usr/local/etc/bash_completion.d/git-prompt.sh
                    fi

            </section>
            <section data-markdown>
                # git config alias

                    $ git --global config alias.au 'add -u'

                Sets

                    [alias]
                    au = add -u

                *Use `--global` for aliases*

            </section>
            <section data-markdown>
                # alias git amend

                    $ git config alias.amend 'commit --amend -C HEAD'

                ## Explanation
                    commit  = The commit command
                    --amend = Amend the changes to previous commit
                    -C HEAD = Reuse the commit message

                    # Alternative
                    -c HEAD = Lets you edit the message
            </section>
            <section data-markdown>
                # alias git ld

                    git config alias.ld 'log --diff-filter=D --summary'

                Show commits with deleted files

                ## Explanation
                    log             = The log command
                    --diff-filter=D = Only commits with deleted files
                    --summary       = Show changes such as deletion, etc

            </section>
            <section data-markdown>
                # alias git hist
                ![git-hist](git-hist.png)
            </section>
            <section data-markdown>
                # git hist explained

                    $ git config alias.hist 'log --pretty='format:%C(blue)%h%C(red)%d%C(yellow) %s %C(green)%an%Creset, %ar' --graph'

                ## Explanation

                <pre><code>log               = The log command
                --graph           = Text-based graphical representation
                --pretty='format' = Format according to spec
                %C(color)         = Change color
                %h&nbsp;               = Abbreviated commit hash (6b266c2)
                %d&nbsp;               = Ref names (HEAD, origin/master)
                %s&nbsp;               = Subject (first line of comment)
                %an               = Author name
                %ar               = Author date, relative</code></pre>
            </section>

        </section>
        <section>
            <section data-markdown>
                # Under the Hood
                ![](under-the-hood-sally-storey-jones.jpg)

            </section>
            <section data-markdown>
                # git clone explained
                    $ git clone REPO

                    $ git init
                    $ git remote add origin REPO
                    $ git fetch
                    $ git merge origin/master
                    $ git branch -u origin/master
            </section>
            <section data-markdown>
                # git diff
                ## `./git/config`

                    $ diff gitinit/.git/config gitclone/.git/config
                    7a8,13
                    [remote "origin"]
                        url = https://github.com/andersjanmyr/...
                        fetch = +refs/heads/*:refs/remotes/origin/*
                    [branch "master"]
                        remote = origin
                        merge = refs/heads/master
            </section>
            <section>
                <table>
                    <tbody>
                    <thead>
                    <tr>
                        <th>Command</th>
                        <th>Effect</th>
                    </tr>
                    </thead>
                    <tr class='fragment'>
                        <td><pre><code>git init</code></pre></td>
                        <td>
                            <pre><code>Initialized empty Git repository</code></pre>
                        </td>
                    </tr>
                    <tr class='fragment'>
                        <td><pre><code>git remote add orign REPO</code><pre></td>
                        <td>
                            <pre><code>[remote "origin"]
    url = https://github.com/andersjanmyr/...
    fetch = +refs/heads/*:refs/remotes/origin/*</code></pre>
                        </td>
                    </tr>
                    <tr class='fragment'>
                        <td><pre><code>git fetch</code><pre></td>
                        <td>
                            <pre><code>From github.com:andersjanmyr/git-tips-and-tricks
* [new branch]      master     -> origin/master</code></pre>
                        </td>
                    </tr>
                    <tr class='fragment'>
                        <td><pre><code>git merge origin/master</code><pre></td>
                        <td>
                            Merges local branch <code>origin/master</code> into
                            <code>master</code>. <em>Before this, there is no
                            `master`.</em>
                        </td>
                    </tr>
                    <tr class='fragment'>
                        <td><pre><code>git branch -u origin/master</code><pre></td>
                        <td>
                            <pre><code>[branch "master"]
    remote = origin
    merge = refs/heads/master</code></pre>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </section>
        </section>
        <section>
            <section data-markdown>
                # Github
                ![github](github.png)
            </section>
            <section data-markdown>
                # The `hub` command

                    $ brew install hub
                    $ alias git=hub
            </section>
            <section data-markdown>
                # hub create

                    $ git create
                    [ repo created on GitHub ]
                      git remote add origin git@github.com:YOUR_USER/CURRENT_REPO.git
            </section>
            <section data-markdown>
                # hub clone

                    $ git clone schacon/ticgit
                      git clone git://github.com/schacon/ticgit.git

            </section>
            <section data-markdown>
                # hub remote add

                    $ git remote add origin anders
                      git remote add origin git://github.com/anders/CURRENT_REPO.git
            </section>
            <section data-markdown>
                # hub push
                    $ git push origin,staging,qa master
                      git push origin master
                      git push staging master
                      git push qa master
            </section>
            <section data-markdown>
                # hub pull-request
                    # while on a topic branch called "feature":
                    $ git pull-request
                    [ opens text editor to edit title and body for the request ]
                    [ opened pull request on GitHub for "YOUR_USER:feature" ]
            </section>
            <section data-markdown>
                # hub browse
                    $ git browse -- issues
                      open https://github.com/YOUR_USER/CURRENT_REPO/issues
            </section>
        </section>

        <section data-markdown>
            # Finito
            ### http://anders.janmyr.com
            ### @andersjanmyr
            ### anders.janmyr@jayway.com
        </section>
    </div>


</div>

<script src="reveal.js/lib/js/head.min.js"></script>
<script src="reveal.js/js/reveal.min.js"></script>

<script>

// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
    theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
    transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/none

    // Optional libraries used to extend on reveal.js
    dependencies: [
        { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
        { src: 'reveal.js/plugin/markdown/showdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
        { src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
        { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
        { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
        { src: 'reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
        // { src: 'plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
    ]
});

</script>

</body>
</html>
